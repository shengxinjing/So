# CSS 架构思考 `undone`

ps：这篇文章还没有完成.

最近看了写 CSS 模块化方面的知识，主要是 BEM 和 SMACSS，粗略看了一遍，并结合自己的经历来说说我的感受。

## First

CSS模块化相比于其他语言的模块化而言，并不是指功能的复用，而是界面的复用，这是两者的本质区别。如果界面本身毫无规律可循，CSS模块化也无从谈起，因此**应用CSS模块化的前置条件是有较完善的设计规范和设计库**。

CSS是一门描述性语言，模块化需要在整体设计层面上来做一些约定，确立一些规范，否则模块化就无从说起。

其次，CSS模块化的目标，大致来说有这么几个：复用，复用提升可维护性，同时约定复用的规则，何时复用，如何复用，这样能够推进整个CSS模块化系统的一致性，便于理解与学习。

最后，需要控制CSS模块化的风险，不能因为使用了CSS模块化而同时引入了其他风险。

总结一下，即提升复用和可维护性，规定复用规则，控制新风险。

## BEM

根据BEM的思想，一个模块即一个Block，模块可以处于不同的状态，使用修饰符来表示模块的不同状态，即Modifier。模块由一个个Element组成，这里的Element对应HTML标签，或者可以这样理解，一个可复用的HTML片段应该抽象成模块。元素也能拥有不同的状态，使用元素的修饰符表示元素的不同状态。

BEM的命名规范是 

* .B(--M) 来表示一个模块， 
* .B(--M)__E(--M) 表示模块中的元素。

BEM的模块化思想，其高明之处在于，BEM不仅仅是CSS模块化的概念， 而完整的工程方法。BEM中的模块，不仅有HTML的结构和内容，有CSS所定义的界面，同时还包括JS控制的模块行为，以及相应的多媒体资源（图片、视频、音频等）。这是一个完整的模块，模块内部交由模块自我管理，与模块所处环境完成无关。

**BEM 方案的本质是类选择器和命名空间的结合，以此来满足模块间任意相互嵌套。**

BEM 通过使用类选择器来替代元素选择器，以及使用命名空间约束类名，我们将这些强大的选择器变得更加适合我们的需求，而不是超出我们的期望。这是因为类选择器相比元素选择器更加弱小，而命名空间下的类选择器相比无命名空间的类选择器更加弱小，这样我们解决了是CSS选择器过于强大的问题。

## SMACSS

SMACSS的核心理念是CSS分层，SMACSS将网站的CSS分为五层，Base、layout、Module、State 和 Theme。

Base 层用于规范 HTML 元素的默认样式。Base 层的 CSS 使整个网站的界面风格一致性得到保障，但是 Base 不会定义 class 和 id 样式。

Layout 定义了网站的布局CSS，比如常见的 header、artcile、aside、footer 等网站布局元素。Layout 是 Module 的布局容器。此外，基于栅格系统的 Layout，也是另外一个考虑。

Module 层相当于 BEM 中的复用模块 Block。但 SMACSS 对于 Block 和 Block 状态有更加细致的分类。SMACSS认为 Block 有两类状态，第一类状态是指不同类Block（即内部HTML结构不同，无关上下文），第二种是指不同的界面状态（HTML结构相同，只是Block所处上下文不同，比如小宽度是其中一种状态，hidden也是一种状态）。

SMACSS 区分这两类状态，并针对两种不同状态提供不同的解决方法。

对于第一种无关上下文的模块，使用 sub-module 来表示该状态的模块。比如

```
<div class="nav"></div>

<div class="nav--minor"></div>
```

一般情况下，导航模块是.nav，如果需要调用一个次要的导航，需要使用 .nav--minor。这是两个不同的模块，虽然他们都是导航。

对于第二种上下文相关的模块，SMACSS 使用 State 来改变这些模块的状态，注意，模块或是模块中元素的状态是可以通过JS改变的。

State层存放可以通过JS改变的状态。

Theme层就不多说了
